<script type="text/javascript">
  var swfu;

  window.onload = function() {
    var settings = {
      flash_url : "/flash/swfupload.swf",
      upload_url: "<%= @upload_url %>",
      http_success : [ 200, 201, 204 ],     // FOR AWS

      file_size_limit : "2 GB",
      file_types : "*.*",
      file_types_description : "mp3, mp4 and m4a files only.",
      file_upload_limit : 3,
      file_queue_limit : 0,
      file_post_name : "file",        // FOR AWS

      custom_settings : {
        progressTarget : "fsUploadProgress",
        cancelButtonId : "btnCancel"
      },
      debug: <%= ENV['RAILS_ENV']=='development' ? 'true' : 'false' %>,

      // Button settings
      button_image_url : "/images/walrus.jpg",
      button_placeholder_id : "spanButtonPlaceHolder",
      button_width: 61,
      button_height: 22,

      // The event handler functions are defined in handlers.js
      file_queued_handler : fileQueued,
      file_queue_error_handler : fileQueueError,
      // file_dialog_complete_handler : fileDialogComplete,
      upload_start_handler : uploadStart,
      upload_progress_handler : uploadProgress,
      upload_error_handler : uploadError,
      upload_success_handler : uploadSuccess,
      // upload_complete_handler : uploadComplete,
      queue_complete_handler : queueComplete, // Queue plugin event

      post_params: <%= @post.to_json.html_safe %>   // FOR AWS
    };

    swfu = new SWFUpload(settings);
  };
  
</script>


<div class="grid_12">

  <h2>New Sandwich</h2>

  <form id="form" action="/upload/upload" method="post" enctype="multipart/form-data">
    <div class="fieldset flash" id="fsUploadProgress">
     <span class="legend">Upload Queue</span>
    </div>
    <div id="divStatus">0 Files Uploaded</div>
    <div>
      <span id="spanButtonPlaceHolder"></span>
      <input id="btnCancel" type="button" value="Cancel All Uploads" onclick="swfu.cancelQueue();" disabled="disabled" style="margin-left: 2px; font-size: 8pt; height: 29px;" />
      <input type="button" value="Make Sandwich" id="makesandwich" onclick="swfu.startUpload()" style="margin-left: 2px; font-size: 8pt; height: 29px;" disabled="disabled">
    </div>
  </form>

  <!-- <%= form_tag sandwiches_path, :id => 'new_sandwich', :multipart => true do %>
    <%= error_messages_for :sandwich %>
    <p><%= label_tag "Name" %> <%= text_field_tag :name %></p>
    <p>.mp3, .m4a and .mp4 files only, please.</p>
    <p><%= label_tag "First" %> <%= file_field_tag "songs[1]" %></p>
    <p><%= label_tag "Second" %> <%= file_field_tag "songs[2]" %></p>
    <p><%= label_tag "Third" %> <%= file_field_tag "songs[3]" %></p>
    <p><%= submit_tag "Upload", :id => "new_sandwich_submit" %> (Be patient!)</p>
    <div id="new_sandwich_status"></div>
  <% end %> -->

</div>